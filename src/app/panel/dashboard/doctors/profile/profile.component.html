<p-toast></p-toast>
<div class="flex appt-dialog justify-content-center">
    <p-dialog header="Schedule an appointment" [(visible)]="visible" [modal]="true"
        [breakpoints]="{ '1199px': '75vw', '575px': '90vw' }" [style]="{ width: '60vw', display: 'flex'}"
        [draggable]="false" [resizable]="false">
        <form *ngIf="!preview" action="" [formGroup]="apptFormGroup" class="d-flex m-auto justify-content-between">


            <div class=" calendar justify-content-center">
                <p-calendar class="" formControlName="date" [inline]="true" [showWeek]="false" [showTime]="true"
                    [minDate]="minDate" panelStyle="background-color:blue" />


            </div>
            <div class="diag-text my-auto d-flex justify-content-between flex-column">
                <span class="bi bi-calendar4-week mb-5"></span>
                <p class="mb-5">
                    Booking an Appointment <br><br> with {{professional?.user?.name || SingleDoctor?.user?.name}}<br>
                </p>


                <label for="symptoms">Complaints</label><br>
                <textarea formControlName="symptoms" placeholder="Symptoms you are experiencing" name="symptoms"
                    type="name" pInputText id="name" aria-describedby="username-help"></textarea>
                <small *ngIf="apptFormGroup.get('symptoms')?.touched && apptFormGroup.get('name')?.hasError('required')"
                    class="text-danger">
                    Field Required
                </small><br>


                <p-button [disabled]="this.apptFormGroup.invalid || loading" [loading]="loading" label="Proceed"  (click)="proceed()" severity="info" [raised]="true" [rounded]="true" />
            </div>
        </form>
        <!-- <div *ngIf="preview">
            <h3 class="primary-color">Preview</h3>
            <hr>
            <div class='d-flex'>
               <span class="col-6">
                   <h2>Date and time:</h2>

               </span>
               <span class="col-6">

                   <small>{{this.formData.date_time  }}</small>
               </span>
            </div>
            <div class='d-flex'>
            <span class="col-6">
                <h2>Complaints</h2>
            </span>
            <span class="col-6">
            
                <small>{{this.formData.symptoms}}</small>
            </span>
            </div>

            <p-button label="Back" type="submit" (click)="back()" [style]="{ backgroundColor: 'white'}" severity="info" [raised]="true" [rounded]="true" />
            <p-button label="Submit" type="submit" (click)="submit()" severity="info" [raised]="true" [rounded]="true" />
            
           
        </div> -->

      



    </p-dialog>
</div>

<main class="d-flex flex-column flex-wrap">

    <section class="hero p-3">

        <!-- <p>{{SingleDoctor.user.name}}</p> -->
    </section>

    <section class="main mx-auto d-flex flex-wrap justify-content-between">
        <div class="left-profile ">
            <div class="inner-profile d-flex flex-column pb-2">
                <app-lazy-image 
                    class="m-auto"
                    [src]="avatar_file + (professional?.user?.passport || SingleDoctor?.user?.passport || '')"
                    [alt]="(professional?.user?.name || SingleDoctor?.user?.name) || 'Profile'"
                    width="150px"
                    height="150px"
                    borderRadius="50%">
                </app-lazy-image>
                <p-skeleton *ngIf="!professional && !SingleDoctor" shape="circle" size="150px" styleClass="m-auto"></p-skeleton>
                <h1 class="m-2">{{professional?.user?.name || SingleDoctor?.user?.name}}</h1>
                <p class="m-2">{{professional?.specialization || SingleDoctor?.specialization}}</p>
                <p class="m-2" *ngIf="professionalType === 'other_professional'">{{professional?.professional_type}}</p>
                <p-tag *ngIf="professionalType === 'doctor' && (professional?.availability === '0' || SingleDoctor?.availability === '0')" value="Unavailable" severity="danger"></p-tag>
                <p-tag *ngIf="professionalType === 'doctor' && (professional?.availability === '1' || SingleDoctor?.availability === '1')" value="Available" severity="success"></p-tag>
                <p-tag *ngIf="professionalType === 'other_professional'" value="Available" severity="info"></p-tag>
            </div>
        </div>
        <div class="right-profile p-2">
            <span *ngIf="user.appointments">
                <div *ngIf="user.appointments.status=='pending'" class="alert alert-warning">
                    <p>You have a pending appointment</p>
                </div>
            </span>
            <div class="m-2">
                <h1 class="primary-color">Profile</h1>
                <div class="d-flex flex-wrap">

                    <h3 class="col-6">{{professional?.user?.name || SingleDoctor?.user?.name}}</h3>
                    <small class="col-6">{{professional?.license_number || SingleDoctor?.license_number}}</small>
                    <p class="col-12">{{professional?.specialization || SingleDoctor?.specialization}}</p>
                    <p class="col-12" *ngIf="professionalType === 'other_professional'"><strong>Type:</strong> {{professional?.professional_type}}</p>
                </div>
            </div>
            <div class="m-2">
                <h1 class="primary-color">Experience</h1>
                <span class="d-flex">
                    <p class="col-6">{{professional?.med_school || SingleDoctor?.med_school}}</p>
                    <p class="col-6">{{professional?.grad_year || SingleDoctor?.grad_year}}</p>
                </span>
            </div>
            <!-- <div class="m-2">
                <h1 class="primary-color">Contact</h1>
                <span class="d-flex flex-wrap">
                    <p class="col-12">{{professional?.user?.email || SingleDoctor?.user?.email}}</p>
                    <p class="col-12">{{professional?.user?.phoneno || SingleDoctor?.user?.phoneno}}</p>
                </span>
            </div> -->

            <span *ngIf="user?.clients?.appointments">
                    <p-button [disabled]="appointment" label="Book Appointment" (click)="showDialog()" severity="info" [raised]="true"
                        [rounded]="true" />
                </span>
                <span *ngIf="!user?.clients?.appointments">
                    <p-button label="Book Appointment" (click)="showDialog()" severity="info" [raised]="true"
                        [rounded]="true" />
                </span>


        </div>
    </section>
</main>